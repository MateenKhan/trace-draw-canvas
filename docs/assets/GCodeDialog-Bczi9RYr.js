import{c as O,r as t,j as e,a as G,t as L}from"./index-DGqWCeH1.js";import{D as Y,e as J,g as K,T as Q,a as W,b as D,P as F,c as M,L as o,S as A,d as B,f as z,h as I,i as v,j as f,k as ee,B as y,E as se,l as ae,R as te,C as le,m as ne,u as ce,p as ie,n as re,o as oe,q as de,r as xe,s as me,t as ue,v as he,w as pe}from"./Index-CXKYeWVD.js";import{S as je,P as fe,a as ge}from"./skip-forward-CEg675w-.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=O("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=O("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),U=t.forwardRef(({toolPaths:j,onExportGCode:w,onSimulationChange:m},E)=>{const[a,b]=t.useState(Y),[n,g]=t.useState(!1),[u,h]=t.useState(0),[p,d]=t.useState(0),[l,c]=t.useState(!0),i=t.useRef(null),P=J(j,a),N=K(j,a),r=N.split(`
`),V=j.flatMap(s=>s.points),R=V.length,k=R>0?V[Math.min(Math.floor(u/100*R),R-1)]:null;t.useEffect(()=>{m==null||m({isPlaying:n,progress:u,currentLine:p,currentPoint:k,showOverlay:l})},[n,u,p,k,l,m]);const H=t.useCallback(()=>{g(!0)},[]),q=t.useCallback(()=>{g(!1)},[]),_=t.useCallback(()=>{g(!1),h(0),d(0)},[]),$=t.useCallback(()=>{d(s=>Math.min(s+10,r.length-1)),h(s=>Math.min(s+5,100))},[r.length]),Z=t.useCallback(()=>{d(s=>Math.max(s-10,0)),h(s=>Math.max(s-5,0))},[]);t.useEffect(()=>{if(!n||r.length===0){i.current&&(clearInterval(i.current),i.current=null);return}return i.current=setInterval(()=>{d(s=>{const x=s+1;return x>=r.length?(g(!1),h(100),s):(h(x/r.length*100),x)})},80),()=>{i.current&&(clearInterval(i.current),i.current=null)}},[n,r.length]);const X=t.useCallback(()=>{w(N)},[N,w]),T=t.useCallback((s,x)=>{b(S=>({...S,tool:{...S.tool,[s]:x}}))},[]),C=t.useCallback((s,x)=>{b(S=>({...S,cutting:{...S.cutting,[s]:x}}))},[]);return e.jsx("div",{className:"panel w-full animate-slide-up",children:e.jsxs(Q,{defaultValue:"toolpath",className:"w-full",children:[e.jsxs(W,{className:"w-full grid grid-cols-3 gap-1 p-1 bg-secondary/50 rounded-lg",children:[e.jsxs(D,{value:"toolpath",className:"gap-1.5 text-xs",children:[e.jsx(ve,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"hidden md:inline",children:"Tool"})]}),e.jsxs(D,{value:"cutting",className:"gap-1.5 text-xs",children:[e.jsx(Ne,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"hidden md:inline",children:"Cutting"})]}),e.jsxs(D,{value:"simulate",className:"gap-1.5 text-xs",children:[e.jsx(F,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"hidden md:inline",children:"Simulate"})]})]}),e.jsxs(M,{value:"toolpath",className:"space-y-4 p-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{className:"text-xs font-mono uppercase tracking-wider text-muted-foreground",children:"Tool Type"}),e.jsxs(A,{value:a.tool.type,onValueChange:s=>T("type",s),children:[e.jsx(B,{className:"h-9",children:e.jsx(z,{})}),e.jsxs(I,{children:[e.jsx(v,{value:"endmill",children:"End Mill"}),e.jsx(v,{value:"ballnose",children:"Ball Nose"}),e.jsx(v,{value:"vbit",children:"V-Bit"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{className:"text-xs font-mono uppercase tracking-wider text-muted-foreground",children:"Tool Diameter"}),e.jsxs("span",{className:"text-xs font-mono text-primary",children:[a.tool.diameter,"mm"]})]}),e.jsx(f,{value:[a.tool.diameter],onValueChange:s=>T("diameter",s[0]),min:.5,max:12,step:.1,className:"w-full"})]}),a.tool.type==="vbit"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{className:"text-xs font-mono uppercase tracking-wider text-muted-foreground",children:"V-Bit Angle"}),e.jsxs("span",{className:"text-xs font-mono text-primary",children:[a.tool.vbitAngle||60,"Â°"]})]}),e.jsx(f,{value:[a.tool.vbitAngle||60],onValueChange:s=>T("vbitAngle",s[0]),min:15,max:120,step:5,className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{className:"text-xs font-mono uppercase tracking-wider text-muted-foreground",children:"Material"}),e.jsxs(A,{value:a.tool.material,onValueChange:s=>T("material",s),children:[e.jsx(B,{className:"h-9",children:e.jsx(z,{})}),e.jsxs(I,{children:[e.jsx(v,{value:"hss",children:"HSS"}),e.jsx(v,{value:"carbide",children:"Carbide"}),e.jsx(v,{value:"diamond",children:"Diamond"})]})]})]})]}),e.jsxs(M,{value:"cutting",className:"space-y-4 p-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{className:"text-xs font-mono uppercase tracking-wider text-muted-foreground",children:"Feed Rate"}),e.jsxs("span",{className:"text-xs font-mono text-primary",children:[a.cutting.feedRate," mm/min"]})]}),e.jsx(f,{value:[a.cutting.feedRate],onValueChange:s=>C("feedRate",s[0]),min:100,max:5e3,step:50,className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{className:"text-xs font-mono uppercase tracking-wider text-muted-foreground",children:"Plunge Rate"}),e.jsxs("span",{className:"text-xs font-mono text-primary",children:[a.cutting.plungeRate," mm/min"]})]}),e.jsx(f,{value:[a.cutting.plungeRate],onValueChange:s=>C("plungeRate",s[0]),min:50,max:1e3,step:25,className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{className:"text-xs font-mono uppercase tracking-wider text-muted-foreground",children:"Spindle Speed"}),e.jsxs("span",{className:"text-xs font-mono text-primary",children:[a.cutting.spindleSpeed," RPM"]})]}),e.jsx(f,{value:[a.cutting.spindleSpeed],onValueChange:s=>C("spindleSpeed",s[0]),min:1e3,max:3e4,step:500,className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{className:"text-xs font-mono uppercase tracking-wider text-muted-foreground",children:"Depth Per Pass"}),e.jsxs("span",{className:"text-xs font-mono text-primary",children:[a.cutting.depthPerPass," mm"]})]}),e.jsx(f,{value:[a.cutting.depthPerPass],onValueChange:s=>C("depthPerPass",s[0]),min:.1,max:5,step:.1,className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{className:"text-xs font-mono uppercase tracking-wider text-muted-foreground",children:"Total Depth"}),e.jsxs("span",{className:"text-xs font-mono text-primary",children:[a.cutting.totalDepth," mm"]})]}),e.jsx(f,{value:[a.cutting.totalDepth],onValueChange:s=>C("totalDepth",s[0]),min:.5,max:25,step:.5,className:"w-full"})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsx(o,{className:"text-xs font-mono uppercase tracking-wider text-muted-foreground",children:"Coolant"}),e.jsx(ee,{checked:a.coolant,onCheckedChange:s=>b(x=>({...x,coolant:s}))})]})]}),e.jsxs(M,{value:"simulate",className:"space-y-4 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{className:"text-xs font-mono uppercase tracking-wider text-muted-foreground",children:"Show on Canvas"}),e.jsxs(y,{variant:l?"default":"outline",size:"sm",className:"gap-1.5",onClick:()=>c(!l),children:[l?e.jsx(se,{className:"w-3.5 h-3.5"}):e.jsx(ae,{className:"w-3.5 h-3.5"}),l?"Visible":"Hidden"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Progress"}),e.jsxs("span",{className:"font-mono text-primary",children:[u.toFixed(1),"%"]})]}),e.jsx("div",{className:"h-2 bg-secondary rounded-full overflow-hidden",children:e.jsx("div",{className:G("h-full bg-gradient-to-r from-primary to-success transition-all duration-100",n&&"animate-pulse"),style:{width:`${u}%`}})})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(y,{variant:"toolbar",size:"icon",onClick:_,title:"Reset",children:e.jsx(te,{className:"w-4 h-4"})}),e.jsx(y,{variant:"toolbar",size:"icon",onClick:Z,title:"Skip Back",children:e.jsx(je,{className:"w-4 h-4"})}),e.jsx(y,{variant:"default",size:"icon",className:G("w-12 h-12",n&&"bg-success hover:bg-success/80"),onClick:n?q:H,title:n?"Pause":"Play",children:n?e.jsx(fe,{className:"w-5 h-5"}):e.jsx(F,{className:"w-5 h-5"})}),e.jsx(y,{variant:"toolbar",size:"icon",onClick:$,title:"Skip Forward",children:e.jsx(ge,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"bg-secondary/50 rounded-lg p-3",children:[e.jsxs("div",{className:"text-xs text-muted-foreground mb-1",children:["Line ",p+1," / ",r.length]}),e.jsx("code",{className:"text-xs font-mono text-primary block truncate",children:r[p]||"Ready"})]}),k&&e.jsxs("div",{className:"flex items-center gap-4 text-xs font-mono",children:[e.jsx("span",{className:"text-muted-foreground",children:"Position:"}),e.jsxs("span",{className:"text-primary",children:["X: ",k.x.toFixed(2)]}),e.jsxs("span",{className:"text-primary",children:["Y: ",k.y.toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(le,{className:"w-4 h-4"}),"Estimated time: ",P.toFixed(1)," min"]}),e.jsxs(y,{className:"w-full gap-2",onClick:X,disabled:j.length===0,children:[e.jsx(ne,{className:"w-4 h-4"}),"Export G-Code"]})]})]})})});U.displayName="GCodePanel";const ye=t.forwardRef(({open:j,onOpenChange:w,canvas:m,onSimulationChange:E},a)=>{const b=ce(),n=t.useCallback(()=>{if(!m)return[];const p=m.getObjects(),d=[];return p.forEach((l,c)=>{var N;const i=(N=l.toSVG)==null?void 0:N.call(l);if(!i)return;const P=i.match(/d="([^"]+)"/);if(P){const r=ie(P[1],1);r.length>0&&d.push({id:`path-${c}`,name:`Object ${c+1}`,type:"profile",points:r,depth:3,color:"#00ff00"})}}),d},[m]),g=t.useCallback(p=>{const d=new Blob([p],{type:"text/plain"}),l=URL.createObjectURL(d),c=document.createElement("a");c.href=l,c.download="toolpath.gcode",c.style.display="none",/iPhone|iPad|iPod/i.test(navigator.userAgent)&&/Safari/i.test(navigator.userAgent)?(window.open(l,"_blank"),L.success("G-code opened in new tab - use Share > Save to Files")):(document.body.appendChild(c),c.click(),document.body.removeChild(c),L.success("G-code exported successfully")),setTimeout(()=>URL.revokeObjectURL(l),5e3)},[]),u=n(),h=e.jsxs(e.Fragment,{children:[e.jsx(U,{toolPaths:u,onExportGCode:g,onSimulationChange:E}),u.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Add shapes to the canvas to generate toolpaths"})]});return b?e.jsx(re,{open:j,onOpenChange:w,children:e.jsxs(oe,{side:"bottom",className:"h-[50vh] overflow-y-auto rounded-t-xl",children:[e.jsx(de,{children:e.jsx(xe,{className:"flex items-center gap-2",children:e.jsx("span",{className:"text-lg font-semibold",children:"G-Code Generator"})})}),e.jsx("div",{className:"mt-2 pb-4",children:h})]})}):e.jsx(me,{open:j,onOpenChange:w,children:e.jsxs(ue,{ref:a,className:"max-w-lg max-h-[85vh] overflow-y-auto",children:[e.jsx(he,{children:e.jsx(pe,{className:"flex items-center gap-2",children:e.jsx("span",{className:"text-lg font-semibold",children:"G-Code Generator"})})}),e.jsx("div",{className:"mt-2",children:h})]})})});ye.displayName="GCodeDialog";export{ye as GCodeDialog};
